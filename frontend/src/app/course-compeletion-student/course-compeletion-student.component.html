<div class="course-player" *ngIf="currentCourse">
    <div class="course-header">
      <h1>{{ currentCourse.title }}</h1>
      <p>{{ currentCourse.description }}</p>
    </div>
  
    <div class="course-content">
      <!-- Боковая панель с модулями и уроками -->
      <div class="sidebar">
        <div *ngFor="let module of currentCourse.modules; let moduleIndex = index" class="module">
          <h3 (click)="navigateToLesson(moduleIndex, 0)">{{ module.title }}</h3>
          <ul>
            <li *ngFor="let lesson of module.lessons; let lessonIndex = index" 
                [class.active]="moduleIndex === currentModuleIndex && lessonIndex === currentLessonIndex"
                [class.completed]="isLessonCompleted(module.id, lesson.id)"
                (click)="navigateToLesson(moduleIndex, lessonIndex)">
              {{ lesson.title }}
              <span *ngIf="isLessonCompleted(module.id, lesson.id)">✓</span>
            </li>
          </ul>
        </div>
      </div>
  
      <!-- Основной контент урока -->
      <div class="lesson-view">
        <div *ngIf="getCurrentLesson() as lesson; else noLesson">
          <h2>{{ lesson.title }}</h2>
          <p>{{ lesson.description }}</p>
          
          <!-- Контент урока -->
          <div *ngIf="lesson.content_url" class="lesson-media">
            <!-- Для YouTube -->
            <iframe 
              *ngIf="isYoutubeUrl(lesson.content_url)"
              [src]="getSafeYoutubeUrl(lesson.content_url)" 
              width="100%" 
              height="500"
              frameborder="0" 
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
              allowfullscreen>
            </iframe>
            
            <!-- Для обычных видео -->
            <video 
              *ngIf="lesson.type === 'video' && !isYoutubeUrl(lesson.content_url)"
              [src]="lesson.content_url" 
              controls
              width="100%">
            </video>
            
            <!-- Для PDF -->
            <iframe 
              *ngIf="lesson.type === 'pdf'"
              [src]="lesson.content_url" 
              width="100%" 
              height="500px">
            </iframe>
          </div>
      
          <!-- Кнопки навигации -->
          <div class="navigation-buttons">
            <button (click)="completeLesson(currentCourse.modules[currentModuleIndex].id, lesson.id)">
              Завершить урок
            </button>
            <button (click)="nextLesson()">Следующий урок</button>
          </div>
        </div>
      
        <ng-template #noLesson>
          <p>Урок не найден.</p>
        </ng-template>
      </div>
    </div>
  </div>